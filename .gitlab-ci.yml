stages:
  - check
  - test

check:
  stage: check
#  only:
#    - tags
  script:
    - bash .wex/script/ciCheck.sh
    - echo "COMPOSER_PACKAGE_DIR=${CI_PROJECT_DIR}" > .env.symfony-composer
  artifacts:
    reports:
      dotenv: .env.skip

test:
  stage: test
#  only:
#    - tags
  rules:
    - if: '$SKIP_BUILD != "true"'
  needs:
    - check
  trigger:
      project: wexample/symfony-composer
      branch: master
      strategy: depend
  variables:
    COMPOSER_PACKAGE: $PROJECT_A_DIR